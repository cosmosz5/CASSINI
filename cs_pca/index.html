<!DOCTYPE html>
<html lang="en">
    <head>
      <script>
	// Hack for scrolling window when linking to anchor tag with fixed nav header
        var shiftWindow = function() { scrollBy(0, -75) };
        window.addEventListener("hashchange", shiftWindow);
        function load() { if (window.location.hash) shiftWindow(); }
      </script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Compressed Sensing PCA - CASSINI</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/http.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../js/base.js"></script> 
    </head>

    <body class="">

      <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
	<div class="container">
	<a class="navbar-brand" href="..">CASSINI</a>
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
	</button>

	<div class="collapse navbar-collapse">
          <!-- Main navigation -->
          <nav class="nav">
            <ul class="navbar-nav">
              <li >
                <a class="nav-link" href="..">Home</a>
              </li>
              <li >
                <a class="nav-link" href="../about/">Compressed Sensing for SAM</a>
              </li>
              <li class="active">
                <a class="nav-link" href="./">Compressed Sensing PCA</a>
              </li>
            </ul>
          </nav>

          <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
            <li class="nav-item">
              <a class="nav-link" href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
		<i class="fa fa-search"></i> Search
              </a>
            </li>
          </ul>
	</div>
	</div>
      </nav><div id="content" class="container">
        
      <div class="row">
        <div class="col-md-9" role="main">


<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    
    <li class="breadcrumb-item active" aria-current="page">Compressed Sensing PCA</li>
  </ol>
</nav>


<h1 id="this-repository-includes-software-to-perform-principal-component-analysis-for-infrared-interferometric-imaging-based-on-compressed-sensing-cassinipca-v10">This repository includes software to perform Principal Component Analysis for infrared interferometric imaging based on Compressed Sensing (CASSINI/PCA V1.0)</h1>
<h1 id="link-to-the-github-repository-with-the-code-click-here">Link to the GitHub repository with the code, click <a href="https://github.com/cosmosz5/CASSINI/tree/develop">HERE</a></h1>
<h2 id="1-principal-component-analysis">1 Principal Component Analysis</h2>
<p>Principal Component Analysis, or PCA, is a dimensionality-reduction method, which transform a large set of variables into a smaller one that still contains most of the information in the large set. In this repository, we include a series of scripts to perform PCA on recovered infrared interferometric images. These images could be obtained with <a href="../about/"><strong>CASSINI/LASSO</strong></a> or with any other image reconstruction software (e.g., <a href="https://www.astro.phy.cam.ac.uk/research/ResearchFacilities/software-for-astrophyiscs/bsmem">BSMEM</a>, <a href="https://github.com/fabienbaron/squeeze">SQUEEZE</a> or <a href="https://cral-perso.univ-lyon1.fr/labo/perso/eric.thiebaut/?Software/MiRA">MiRA</a>). The purpose of applying PCA to interferometric images is to evaluate the quality of the reconstructions in terms of the features observed in the image. Very recently <a href="https://arxiv.org/pdf/1804.05903.pdf">Medeiros et al. (2020)</a> has demonstrated that PCA is a potential technique to characterize variability in reconstructed images from sparse interferometric data. </p>
<p>Those authors demonstrated that the Fourier transforms of eigenimages derived from PCA applied to an ensemble of images in the spatial-domain are identical to the eigenvectors of PCA applied to the ensemble of the Fourier transforms of the images. This means that the visibilities of interferometric data can be represented as a linear combination of the Fourier transform of the principal components of the reconstructed images. </p>
<h2 id="2-visibilities-from-pca">2 Visibilities from PCA</h2>
<p align="justify">
Here, we included some tools to perform this kind of analysis. As example on the usability of the code, we include reconstructed images from data obtained with GRAVITY/VLTI data using SQUEEZE. The cube of images is included together with the code in the <strong>CASSINI/PCA</strong> directory. The data cube consists in 307 reconstruced images (513 x 513 pixels) of a compact young stellar object. Figure 1 shows the mean image out of the 307 frames in the cube. It can be appreciated that the image shows a central elongated object. Also, two secondary lobes, due to the sparsity of the u-v plane, are observed in the image.  
</p>

<figure>
<p><img alt="Dummy image" height="400" src="../Images2/mean_bootstraping.png" width="400" />
  </p>
<figcaption>Fig 1. Mean reconstructed image of the source used for PCA analysis. </figcaption>
</figure>
<p>The code uses the following input parameters: </p>
<pre><code class="language-py">
#######  The tolowing parameters are necessary to run CASSINI/PCA ##################
cube_filename = 'cube_example.fits' ## The data cube with the reconstructed images
oifits_filename = 'oifits_example.fits' ## The oifits file with the interferometric data to be modeled

### For fitting 1 #####
n_comp = 50 ###Number of components to be extracted from the image, it has to be less or equal than the number of frames in the cube
scale = 0.1 ### Pixel scale used in the reconstruction of the images (mas)
n_comp_compiled = 10 ## Number of components to be added and stored into a .fits file for visualization purposes (it has to be &lt;= n_comp)
display = True ## Bolean variable, it is used to display a plot of the 10 principal components in the image (in n_comp has to be equal or larger than 10)
#lambd_values = [0.01]
lambd_values1 = np.logspace(-2, 3, 5)
</code></pre>
<p><mark>PCA_im.py</mark> computes number of principal components defined with <mark>n_comp</mark>. The variable <mark>n_comp_compiled</mark> defines the number of principal components to be used to recover the visibilities through a minimization based on compressed sensing. The <mark>n_comp_compiled</mark> value has to be equal or lower to the total number of principal components computed by the code.  In case <mark>display=True</mark> the code wil produce a plot of the initial 10 components (see Figure 2). <strong>NOTE: The number of extracted components should be larger or equal than 10. Otherwise, the code will complain/crash!.</strong> </p>
<figure>
<p><img alt="Dummy image" height="350" src="../Images2/principal_components.png" width="800" />
  </p>
<figcaption>Fig 2. Panels with the 10 different components produced by the data in the example included with the code. </figcaption>
</figure>
<p>The <mark>lambd_values1</mark> parameter correspond to the hyperparameter values used for the compressed sensing computation of the visibilities from the dictionary of structures extracted from the Principal Components of the image cube. <mark>lambd_values1</mark> could take a float or an array of values. 
By default, the code will solve the compressed sensing problem using the Python package <a href="https://www.cvxpy.org">cvxpy</a>. However, the code allows the user to use other two Python packages, <a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.linear_model">sklearn.decomposition</a> and <a href="https://pylops.readthedocs.io/en/latest/">PyLops</a>, to solve the Compressed Sensing reconstruction of the vislibilities. In order to enable these options, the user has to declare as True the following two boolean variables:</p>
<pre><code class="language-py">sklearn_opt = True
lambd_values2 = np.logspace(-2, 3, 5) ##Lambda values for CS solver using scikit-learn
pylops_opt = True
lambd_values3 = np.logspace(-2, 3, 5) ##Lambda values for CS solver using pylops
</code></pre>
<p>Notice that the <mark>lambd_values2</mark> and <mark>lambd_values3</mark> should be declared as float or array. Notice that these values could be similar to <mark>lambd_values1</mark>. However, they could produce different results. This is because the different Python solvers use different methods for finding the eigenvalues (&alpha;). Nevertheless, the purpose of using different solvers is that the user could have the possibility to check how these results affect the reconstruction based on the morphological properties of the source in the image. </p>
<p>Each compressed sensing solver produces a cube of images stored in <strong>.fits</strong> files. A <strong>.fits</strong> file is produced for each hyperparameter used. Each <strong>.fits</strong> cube contains with the principal components from the image weighted by their corresponding eigenvalues to recover the visibility values. The user can use these cube of images to evaluate he controbution of the different components to the final recovered structure of the target. For each compressed sensing solve, the code produces a plot with the reconstruction of the visibilities and phases from the number of components defined in <mark>n_comp_compiled</mark> for each one of the hyperparameter value used. Figure 3 shows an example of this plot, similar plots are also produced if the other two solvers are enabled.  </p>
<figure>
<p><img alt="Dummy image" height="800" src="../Images2/visibilities_cvxpy.png" width="500" />
  </p>
<figcaption>Fig 3. Visibilities recovered from the principal components of the cube of reconstructed images. The visibility amplitudes (upper panel) and the phases (lower panel) are reovered using a compressed sensing solver of the Fourier Transform of the principal components at the u-v frequencies traced with the inteferometer. The compressed sensins solver uses the number of components defined in <mark>n_comp_compiled</mark>. The different colors in the plot indicates the visibility extractions using different hyperparameter (λ) values. </figcaption>
</figure>
<p>For the default <mark>cvxpy</mark> solver, the code also produces an image that traces the regularization path of the different sparse eigenvalues for which each principal component image is multiplied. Notice that for an extreme case, where the hyperparameter λ over-regularizes the data, the eigenvalues beta decay to zero (see Figure 4).    </p>
<figure>
<p><img alt="Dummy image" height="400" src="../Images2/regularization_path_cvxpy.png" width="550" />
  </p>
<figcaption>Fig 4. Visibilities recovered from the principal components of the cube of reconstructed images. The visibility amplitudes (upper panel) and the phases (lower panel) are reovered using a compressed sensing solver of the Fourier Transform of the principal components at the u-v frequencies traced with the inteferometer. The compressed sensins solver uses the number of components defined in <mark>n_comp_compiled</mark>. The different colors in the plot indicates the visibility extractions using different hyperparameter (λ) values. </figcaption>
</figure>
<p>For the <mark>sklearn</mark> solver, the code also produces an image that displays the number of non-zero coefficients in the &alpha; values for the different hyperameter  (λ) values used in the reconstruction (see Figure 5). </p>
<figure>
<p><img alt="Dummy image" height="400" src="../Images2/non_zero_coefficients.png" width="550" />
  </p>
<figcaption>Fig 5. Number of non-zero &alpha; coefficients for each visibility reconstruction for a given hyperparameter </figcaption>
</figure>
<p><strong>NOTE: The code delivered here is still under construction. Please use it with caution. Future improvements include more in-depth analysis of the plots and images generated by CASSINI/PCA. </strong></p>

<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  <li class="last-updated-holder displayDate loading">
    <span class="last-updated-text">Last updated:</span>
    <time role="presentation" datetime="2018-10-25T00:00:00.000Z" data-article-date-source="ms.date"></time>
  </li>
<!--
  <li class="readingTime">
    2 minutes to read
  </li>
-->
  <li class="contributors-holder">
    <span class="contributors-text">Contributors</span>
    <ul class="contributors" data-bi-name="contributors"></ul>
  </li>
</ul>
</div>
        <div class="col-md-3"><div class="navbar-light navbar-expand-md hidden-print sticky-top sticky-offset" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    <div id="toc-collapse" class="navbar-collapse collapse card">
        <ul class="nav flex-column bs-sidenav">
            <li class="nav-item main"><a class="nav-link" href="#this-repository-includes-software-to-perform-principal-component-analysis-for-infrared-interferometric-imaging-based-on-compressed-sensing-cassinipca-v10">This repository includes software to perform Principal Component Analysis for infrared interferometric imaging based on Compressed Sensing (CASSINI/PCA V1.0)</a></li>
            <li class="nav-item main"><a class="nav-link" href="#link-to-the-github-repository-with-the-code-click-here">Link to the GitHub repository with the code, click HERE</a></li>
                <li class="nav-item">
                    <a href="#1-principal-component-analysis" class="nav-link">1 Principal Component Analysis</a>
                </li>
                <li class="nav-item">
                    <a href="#2-visibilities-from-pca" class="nav-link">2 Visibilities from PCA</a>
                </li>
        </ul>
    </div>
</div></div>
      </div>
      </div>

      <footer class="col-md-12">
	<hr>
	<div class="container">
	  <p>Author - Joel Sanchez Bermudez (Instituto de Astronomia de la Universidad Nacional Autonoma de Mexico). This code has been developed with funding from the UNAM PAPIIT project IA 101220 and from the Mexico's National Council of Science and Technology (CONACyT) “Ciencia de Frontera” project 263975</p>
	</div>
      </footer>
      <script>
	var base_url = "..",
            shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
      </script>
      <script src="../js/base.js" defer></script>
      <script src="../search/main.js" defer></script>

      <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <p class="h4 modal-title">Keyboard Shortcuts</p>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
